<!DOCTYPE html>
  <html>
    <head>
      <!--Import Google Icon Font-->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!-- Import bootstrep-->
      <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"> -->
      
      <title>Login</title>
      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style>
      .ali{
        text-align: center;
      }
      .caixa{
        margin-top: 150px;
        background-color: #fff;
        width: 50%;
        padding: 10px;
        box-shadow: 1px 1px 1px #000;
        margin-left: auto;
        margin-right: auto;
        border-radius: 10px;
        
      }
      body{
        background-color:white;
        background-image:url("images/marvin-meyer-571072-unsplash.jpg");
        background-size: 100%;
        background-repeat: no-repeat;  
      }
      

    </style>
    </head>
    <title>Login</title>
  <body>
  <div class="caixa">
    <h4 style="text-align:center">Bem vindo a FIND</h4>
    <div class="row">
      <div class="col s12">
        <div class="row">
          <div class="col s3">

          </div>
          <div class="col s6">

            <form onsubmit="return false;"><!--Inicio do formulario de login-->
              
              <div class="input-field col s12">
                <input id="usuario" type="email" class="validate" maxlength="100" size="2">
                <label for="E-mail">E-mail</label>
              </div>

              <div class="input-field col s12">
                <input id="senha" type="password" class="validate" maxlength="255" size="10">
                <label for="Senha">Senha</label>
              </div>
              
            <div>
              
            
              <button class="btn waves-effect waves-light col s6" type="submit" onclick="logar();" name="action">Logar
                <i class="material-icons right">send</i>
              </button>
              <button class="btn waves-effect red col s6" type="submit"  onclick="logarProfessor();" name="action">Professor
                <i class="material-icons right">send</i>
              </button>
            </div>  
              

              <a class="col s12 ali" href="CadCadastro.html"> Matruculize</a>
            
            </div>
            </form><!--FIM do formulario de login-->
            
          

          <div class="col s3">

          </div>

        </div>
      </div>
    </div>    
  </div>

  <script type="text/JavaScript">
    function logar(){
        var url="http://localhost:5000/API/loginUsuario";
        //vamos pegar o s dados do formulario
        var usuario = document.getElementById("usuario").value;
        var senha = document.getElementById("senha").value;

        /*Vamos "casar" os campos da api com os valores do formulário*/

        var dados = {};
        dados.Email = usuario;
        dados.senha = senha;
        
        //abaixo iremos passar para o formato  de json
        var json = JSON.stringify(dados)

        //Vamos fazer uma instancia do objento XMLHttpRequest
        var xhr = new XMLHttpRequest();

        /*Vamos expor a url com o comando open e passar o verbo do rest (POST),a url da api e se aceita o retorno ou não (true)*/
        xhr.open("POST",url,true)

        //Vamos dizer como será a passagem de dados a api.Neste caso iremos usar o json

        xhr.setRequestHeader("Content-type","application/json;charset=utf-8");

        xhr.onload = function(){
            if(xhr.status >= 200 && xhr.status < 400){
                //alert("Login feito com sucesso !!!");
                console.log(xhr);

            //vamos capturar o tokem gerado
            var tokenUS = JSON.parse(this.response);    
            //console.log(tokenUS.accessToken);


            //vamos redirecionar para a pagina listar clientes
            window.location.replace("Curso.html?inf="+tokenUS.accessToken);
            }
            else{
                alert("Erro ao tentar logor");
                window.location.replace("login.html");
            }
        }
        xhr.send(json);
    }    
    function logarProfessor(){
        var url="http://localhost:5000/API/loginProfessor";
        //vamos pegar o s dados do formulario
        var usuario = document.getElementById("usuario").value;
        var senha = document.getElementById("senha").value;

        /*Vamos "casar" os campos da api com os valores do formulário*/

        var dados = {};
        dados.Email = usuario;
        dados.Senha = senha;
        
        //abaixo iremos passar para o formato  de json
        var json = JSON.stringify(dados)

        //Vamos fazer uma instancia do objento XMLHttpRequest
        var xhr = new XMLHttpRequest();

        /*Vamos expor a url com o comando open e passar o verbo do rest (POST),a url da api e se aceita o retorno ou não (true)*/
        xhr.open("POST",url,true)

        //Vamos dizer como será a passagem de dados a api.Neste caso iremos usar o json

        xhr.setRequestHeader("Content-type","application/json;charset=utf-8");

        xhr.onload = function(){
            if(xhr.status >= 200 && xhr.status < 400){
                //alert("Login feito com sucesso !!!");
                console.log(xhr);

            //vamos capturar o tokem gerado
            var tokenUS = JSON.parse(this.response);    
            //console.log(tokenUS.accessToken);


            //vamos redirecionar para a pagina listar clientes
            window.location.replace("CadCurso.html?inf="+tokenUS.accessToken);
            }
            else{
                alert("Erro ao tentar logor");
                // window.location.replace("login.html");
            }
        }
        xhr.send(json);
    }    
</script>
  <!--JavaScript at end of body for optimized loading-->
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  
  <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script> -->

  </body>
</html>